metadata={systemName:"AWS-S3-Bucket",displayName:"AWS S3 Bucket",description:"Connect to your Amazon Web Services S3 Bucket.",configuration:{AWSRegion:{displayName:"AWS Region",type:"string",value:"us-west-2",required:!0},AWSBucketName:{displayName:"AWS Bucket Name",type:"string",value:"s3-bucket-name",required:!0},AWSAccessKey:{displayName:"AWS IAM User Access Key",type:"string",value:"IAM User Access Key",required:!0},AWSSecretKey:{displayName:"AWS IAM User Secret Key",type:"string",value:"IAM User Secret Key",required:!0}}},ondescribe=async function({configuration:e}){postSchema({objects:{AWSS3Bucket:{displayName:"AWS S3 Bucket",description:"Get S3 Bucket Content List of Objects",properties:{Key:{displayName:"Key",type:"string"},LastModified:{displayName:"Last Modified",type:"dateTime"},ETag:{displayName:"Etag",type:"string"},Size:{displayName:"Size",type:"number"},StorageClass:{displayName:"Storage Class",type:"number"}},methods:{GetBucketContents:{displayName:"Get Bucket Contents",type:"list",parameters:{prefix:{displayName:"Prefix",description:"Directory Path",type:"string"},"max-keys":{displayName:"Max Keys",description:"Number of Records to List. The Take.",type:"number"},"start-after":{displayName:"Start After",description:"Key to Start After for Pagination. The Skip.",type:"string"}},inputs:["prefix","max-keys","start-after"],outputs:["Key","LastModified","ETag","Size","StorageClass"]}}},AWSS3File:{displayName:"AWS S3 File",description:"Add or Delete AWS S3 Files",properties:{Key:{displayName:"Key",type:"string"}},methods:{CreateFile:{displayName:"Persist a file to S3",type:"execute",parameters:{Key:{displayName:"Key",description:"File Path, Name and Extension (Ex: ParentDirectory/Directory/DocumentName.ext)",type:"string"}},inputs:["Key","File"],requiredInputs:["Key","File"],outputs:["Key"]},DeleteFile:{displayName:"Remove a file from S3",type:"delete",parameters:{Key:{displayName:"Key",description:"File Path, Name and Extension (Ex: ParentDirectory/Directory/DocumentName.ext)",type:"string"}},inputs:["Key"],requiredInputs:["Key"],outputs:["Key"]}}}}})},onexecute=async function({objectName:e,methodName:t,parameters:a,properties:s,configuration:r,schema:n}){switch(e){case"AWSS3Bucket":await async function(e,t,a){switch(e){case"GetBucketContents":await function(e,t){return new Promise((a,s)=>{var r={"max-keys":t["max-keys"],prefix:t.prefix,"start-after":t["start-after"]},n={Key:e.Key,LastModified:e.LastModified,ETag:e.ETag,Size:e.Size,StorageClass:e.StorageClass};!function(e,t,a,s){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(201!=r.status&&200!=r.status){if(400==r.status||404==r.status)throw e=JSON.parse(r.responseText),new Error(e.code+": "+e.message+". Data: "+t);throw postResult({}),e=JSON.parse(r.responseText),new Error(e.code+": "+e.message+". Data: "+t)}var e=JSON.parse(r.responseText);"function"==typeof s&&s(e)}};var n=function(e){const t=[];for(let a in e){let s=e[a];t.push(encodeURIComponent(a)+"="+encodeURIComponent(s))}return t.join("&")}(t);r.open(a.toUpperCase(),e),r.withCredentials=!0,r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(n)}(function(e){let t="https://"+metadata.configuration.AWSBucketName+".s3."+metadata.configuration.AWSRegion+".amazonaws.com?list-type=2&max-keys=";for(let a in e)if(e[a]){let s=e[a];t+="&"+encodeURIComponent(a)+"="+encodeURIComponent(s)}return t}(r),n,"GET",(function(e){postResult({status:e.status}),a()}))})}(t,a);break;default:throw new Error("The method "+e+" is not supported.")}}(t,s,a);break;case"AWSS3File":await async function(e,t,a){switch(e){case"create":await function(e,t){return new Promise((a,s)=>{var r=new XMLHttpRequest;if(r.onreadystatechange=function(){try{postResult({Key:t.Key}),a()}catch(e){s(e)}},"string"!=typeof e.Key)throw new Error('properties["Key"] is not of type string');r.open("POST","https://"+metadata.configuration.AWSBucketName+".s3."+metadata.configuration.AWSRegion+".amazonaws.com?list-type=2&max-keys="+encodeURIComponent(t["max-keys"])+"&prefix="+encodeURIComponent(t.prefix)+"&start-after="+encodeURIComponent(t["start=after"])+encodeURIComponent(e.Key)),r.setRequestHeader("aws","aws s3 k2 jssp test"),r.send()})}(t,a);break;case"delete":await function(e,t){return new Promise((a,s)=>{var r=new XMLHttpRequest;if(r.onreadystatechange=function(){try{postResult({Key:t.Key}),a()}catch(e){s(e)}},"string"!=typeof e.Key)throw new Error('properties["Key"] is not of type string');r.open("DELETE","https://"+metadata.configuration.AWSBucketName+".s3."+metadata.configuration.AWSRegion+".amazonaws.com?list-type=2&max-keys="+encodeURIComponent(t["max-keys"])+"&prefix="+encodeURIComponent(t.prefix)+"&start-after="+encodeURIComponent(t["start=after"])+encodeURIComponent(e.Key)),r.setRequestHeader("aws","aws s3 k2 jssp test"),r.send()})}(t,a);break;default:throw new Error("The method "+e+" is not supported.")}}(t,s,a);break;default:throw new Error("The object "+e+" is not supported.")}};
//# sourceMappingURL=index.js.map
